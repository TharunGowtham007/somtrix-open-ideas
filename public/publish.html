<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>SOMTRIX&trade; – Publish an Idea</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    :root{--accent:#7F8CBD;--muted:#6c7689;--card:#fff;--radius:16px;--maxw:900px}
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(145deg,#eef2fb,#dfe7ff);color:#111}
    .wrap{max-width:var(--maxw);margin:20px auto;padding:16px}
    header{display:flex;align-items:center;gap:12px}
    .logo{width:60px;height:60px;border-radius:50%;background:#fff;display:flex;align-items:center;justify-content:center}
    nav{margin-left:auto;display:flex;gap:12px}
    .card{background:var(--card);padding:18px;border-radius:18px;border:1px solid rgba(200,210,230,0.7);box-shadow:0 12px 30px rgba(0,0,0,0.05)}
    form{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{font-size:12px;color:var(--muted)}
    input[type="text"], textarea, select{width:100%;padding:10px;border-radius:10px;border:1px solid #d8dfef;resize:vertical}
    textarea{min-height:120px;grid-column:1/-1}
    .full-row{grid-column:1/-1}
    .btn{display:inline-block;padding:10px 14px;border-radius:999px;background:var(--accent);color:#fff;text-decoration:none;border:none;font-weight:700}
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    @media(max-width:760px){form{grid-template-columns:1fr} .logo{width:50px;height:50px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo"><img src="logo.png" alt="SOMTRIX" style="width:44px"></div>
      <div>
        <div style="font-weight:800">SOMTRIX&trade;</div>
        <div style="color:var(--muted)">Publish an idea</div>
      </div>
      <nav style="margin-left:auto">
        <a href="index.html" style="color:var(--muted);text-decoration:underline">Home</a>
        <a href="vote.html" style="color:var(--muted);text-decoration:underline">Vote</a>
        <a href="products.html" style="color:var(--muted);text-decoration:underline">Products</a>
      </nav>
    </header>

    <main class="card" style="margin-top:14px">
      <h2 style="margin:0 0 6px">Submit a public idea</h2>
      <p class="hint">Share a public idea — avoid posting secrets or proprietary content.</p>

      <form id="idea-form">
        <div>
          <label for="author">Your name (optional)</label>
          <input id="author" name="author" type="text" maxlength="60" placeholder="e.g. Tharun G.">
        </div>

        <div>
          <label for="email">Email (optional) — so we can contact you</label>
          <input id="email" name="email" type="text" maxlength="120" placeholder="you@example.com">
        </div>

        <div class="full-row">
          <label for="category">Category (choose or type)</label>
          <input list="categories" id="category" name="category" placeholder="e.g. Home, Health, Kitchen, Clothing, Mobility, IoT, Education">
          <datalist id="categories">
            <option>Home</option>
            <option>Health</option>
            <option>Kitchen</option>
            <option>Clothing</option>
            <option>Mobility</option>
            <option>IoT</option>
            <option>Education</option>
            <option>Office</option>
            <option>Safety</option>
            <option>Sports</option>
            <option>Agriculture</option>
            <option>Energy</option>
            <option>Other</option>
          </datalist>
        </div>

        <div class="full-row">
          <label for="title">Idea title *</label>
          <input id="title" name="title" type="text" maxlength="160" required placeholder="Short, clear title">
        </div>

        <div class="full-row">
          <label for="problem">Problem *</label>
          <textarea id="problem" name="problem" maxlength="1000" required placeholder="Describe the exact problem and who faces it"></textarea>
        </div>

        <div class="full-row">
          <label for="solution_hint">Solution hint (high-level) *</label>
          <textarea id="solution_hint" name="solution_hint" maxlength="600" required placeholder="High-level direction — not the full recipe"></textarea>
        </div>

        <div class="full-row" style="display:flex;gap:12px;align-items:center;justify-content:flex-end">
          <div style="flex:1;color:var(--muted);font-size:13px">By posting, you confirm this text is okay to be public.</div>
          <button class="btn" type="submit">Post idea</button>
        </div>
      </form>

      <div id="status" style="margin-top:12px;color:green;display:none">Your idea has been published.</div>
    </main>
  </div>

  <script>
    const API_BASE = '';
    const form = document.getElementById('idea-form');
    const status = document.getElementById('status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      status.style.display = 'none';
      const data = {
        author: form.author.value.trim(),
        email: form.email.value.trim(),
        category: form.category.value.trim(),
        title: form.title.value.trim(),
        problem: form.problem.value.trim(),
        solution_hint: form.solution_hint.value.trim()
      };
      if (!data.title || !data.problem || !data.solution_hint) {
        alert('Please fill required fields');
        return;
      }
      try{
        const res = await fetch(API_BASE + '/api/ideas', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(data)
        });
        if(!res.ok) {
          const err = await res.json().catch(()=>({error:'Failed'}));
          throw new Error(err.error || 'Failed');
        }
        await res.json();
        form.reset();
        status.style.display = 'block';
      }catch(err){
        alert('Unable to submit idea: ' + (err.message || ''));
        console.error(err);
      }
    });
  </script>
</body>
</html>
